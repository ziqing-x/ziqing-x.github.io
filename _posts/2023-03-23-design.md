---
title: c++ä¸­çš„23ç§è®¾è®¡æ¨¡å¼
tags: [è®¾è®¡æ¨¡å¼]
category: c++
description: å¦‚ä½•è®¾è®¡c++ä»£ç ï¼Ÿ
---

## å‰è¨€
ä¸ºä»€ä¹ˆéœ€è¦è®¾è®¡æ¨¡å¼?

+ ä»£ç é‡ç”¨æ€§ (ç›¸åŒåŠŸèƒ½çš„ä»£ç ï¼Œä¸ç”¨å¤šæ¬¡ç¼–å†™)

+ å¯è¯»æ€§ (ç¼–ç¨‹è§„èŒƒæ€§, ä¾¿äºå…¶ä»–ç¨‹åºå‘˜çš„é˜…è¯»å’Œç†è§£)

+ å¯æ‰©å±•æ€§ (å½“éœ€è¦å¢åŠ æ–°çš„åŠŸèƒ½æ—¶ï¼Œéå¸¸çš„æ–¹ä¾¿ï¼Œç§°ä¸ºå¯ç»´æŠ¤)

+ å¯é æ€§ (å½“æˆ‘ä»¬å¢åŠ æ–°çš„åŠŸèƒ½åï¼Œå¯¹åŸæ¥çš„åŠŸèƒ½æ²¡æœ‰å½±å“)

+ ä½¿ç¨‹åºå‘ˆç°é«˜å†…èšï¼Œä½è€¦åˆçš„ç‰¹æ€§


## ğŸ“  è®¾è®¡æ¨¡å¼çš„åŸºæœ¬åŸåˆ™

### å¼€é—­åŸåˆ™

å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚è®©ç¨‹åºæ›´ç¨³å®šæ›´çµæ´»ã€‚

### å•ä¸€èŒè´£åŸåˆ™

ä¸€ä¸ªç±»åº”è¯¥åªè´Ÿè´£ä¸€é¡¹èŒè´£ã€‚

### ä¾èµ–å€’ç½®åŸåˆ™

ä¾èµ–äºæŠ½è±¡(æ¥å£)ï¼Œä¸è¦ä¾èµ–å…·ä½“çš„å®ç°(ç±»)ï¼Œä¹Ÿå°±æ˜¯é’ˆå¯¹æ¥å£ç¼–ç¨‹ã€‚è®©é¡¹ç›®æ‹¥æœ‰å˜åŒ–çš„èƒ½åŠ›ã€‚

### æ¥å£éš”ç¦»åŸåˆ™

åº”å½“å°½é‡ä¸ºå®¢æˆ·ç«¯æä¾›å°çš„å•ç‹¬çš„æ¥å£ï¼Œè€Œä¸æ˜¯æä¾›å¤§çš„æ€»çš„æ¥å£ã€‚ç³»ç»Ÿæœ‰æ›´é«˜çš„çµæ´»æ€§ã€‚

### è¿ªç±³ç‰¹æ³•åˆ™

åˆå«æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼Œä¸€ä¸ªå¯¹è±¡åº”å½“å¯¹å…¶ä»–å¯¹è±¡å°½å¯èƒ½å°‘çš„äº†è§£ã€‚æ›´å¥½åœ°æ‰©å±•æ€§ã€‚

### é‡Œæ°æ›¿æ¢åŸåˆ™

è½¯ä»¶é‡Œé¢ï¼ŒæŠŠçˆ¶ç±»éƒ½æ›¿æ¢æˆå®ƒçš„å­ç±»ï¼Œç¨‹åºçš„è¡Œä¸ºæ²¡æœ‰å˜åŒ–ï¼Œæ„å»ºæ‰©å±•æ€§æ›´å¥½çš„ç³»ç»Ÿã€‚

### ç»„åˆ/èšåˆåŸåˆ™

å°½é‡ä½¿ç”¨ç»„åˆèšåˆæ¥è¾¾åˆ°å¤ç”¨æ•ˆæœï¼Œå°½é‡å°‘ä½¿ç”¨ç»§æ‰¿ã€‚ç»§æ‰¿ä¸€å®šç¨‹åº¦ä¸Šæ˜¯ç‰ºç‰²äº†å°è£…æ€§æ¥è¾¾åˆ°å¤ç”¨çš„æ•ˆæœçš„ï¼Œè¿™æ ·æœ‰æ—¶æ˜¯å¾—ä¸å¿å¤±çš„ã€‚

## ğŸ“  åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼ˆ6ç§ï¼‰

å•ä¾‹æ¨¡å¼ã€ç®€å•å·¥å‚æ¨¡å¼ã€ å·¥å‚æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼ã€åŸå‹æ¨¡å¼

### 1ã€å•ä¾‹æ¨¡å¼

å•ä¾‹æ¨¡å¼åˆ†ä¸ºæ‡’æ±‰å¼å’Œé¥¿æ±‰å¼ï¼›

+ é¥¿æ±‰å¼ï¼Œå®ä¾‹åœ¨è¿›å…¥main()å‡½æ•°ä¹‹å‰å°±å·²ç»å­˜åœ¨äº†.

+ æ‡’æ±‰å¼ï¼Œç¬¬ä¸€æ¬¡è·å–å®ä¾‹çš„æ—¶å€™æ‰åˆ†é…å†…å­˜ã€‚

è®¾è®¡æ€è·¯:

+ 1ã€æ„é€ å‡½æ•°ç§æœ‰åŒ–ï¼›

+ 2ã€æä¾›ä¸€ä¸ªå…¨å±€çš„é™æ€æ–¹æ³•ï¼›
  

æ‡’æ±‰å¼

```c++
#include <iostream>
#include <string>

template <class T>
class Singleton {
public:
  template <typename... Args>
  static T &GetInstance(Args &&...args) {
    static T instance(std::forward<Args>(args)...);
    return instance;
  }

  Singleton(const Singleton&) = delete;
  Singleton& operator=(const Singleton&) = delete;

protected:
  Singleton() = default;
  ~Singleton() = default;
};

class Person : public Singleton<Person> {
public:
  Person(const std::string &name, int age) {
    name_ = name;
    age_ = age;
  }

  void ShowInfo() {
    std::cout << "å§“å: " << name_ << "\n";
    std::cout << "å¹´é¾„: " << age_ << "\n";
  }

private:
  std::string name_;
  int age_{0};
};

int main() {
  Person::GetInstance("xxx", 15).ShowInfo();
  return 0;
}

```

é¥¿æ±‰å¼

```c++
#include <iostream>
#include <memory>
#include <mutex>
#include <string>

template <class T> 
class Singleton {
public:
  template <typename... Args> 
  static std::unique_ptr<T> &GetInstance(Args &&...args) {
    std::call_once(flag_, [&]() {
      instance_ = std::make_unique<T>(std::forward<Args>(args)...);
    });
    return instance_;
  }

  Singleton(const Singleton&) = delete;
  Singleton& operator=(const Singleton&) = delete;

protected:
  Singleton() = default;
  ~Singleton() = default;

protected:
  static std::unique_ptr<T> instance_;
  static std::once_flag flag_; // ä¿è¯å¤šçº¿ç¨‹è°ƒç”¨æ—¶åªmake_uniqueä¸€æ¬¡
};

template <class T> std::unique_ptr<T> Singleton<T>::instance_= nullptr;
template <class T> std::once_flag Singleton<T>::flag_;


class Person : public Singleton<Person> {
public:
  Person(const std::string &name, int age) {
    name_ = name;
    age_ = age;
  }

  void ShowInfo() {
    std::cout << "å§“å: " << name_ << "\n";
    std::cout << "å¹´é¾„: " << age_ << "\n";
  }

private:
  std::string name_;
  int age_{0};
};

int main() {
  Person::GetInstance("xxx", 15)->ShowInfo();
  return 0;
}
```

+ ç®€çº¦ç‰ˆæ‡’æ±‰å¼

```c++
template<typename T>
class Singleton {
public:
    static T& GetInstance() {
        static T instance;
        return instance;
    }

    Singleton(const Singleton&) = delete;
    Singleton& operator=(const Singleton&) = delete;

protected:
    Singleton() = default;
    ~Singleton() = default;
};
```

### 2ã€ç®€å•å·¥å‚æ¨¡å¼

ç®€å•å·¥å‚æ¨¡å¼åˆå«åšé™æ€å·¥å‚æ¨¡å¼ï¼Œç”¨ä¸€ä¸ªå·¥å‚ç±»æ¥åˆ›å»ºå…¶ä»–ç±»çš„å®ä¾‹ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹é€šå¸¸éƒ½å…·æœ‰å…±åŒçš„çˆ¶ç±»ã€‚

+ ä¾‹å­

```c++
#include "Factory.h"
#include "ConcreteProductA.h"
#include "ConcreteProductB.h"

Product* Factory::CreateProduct(const std::string &name){
  if (!name.compare("A"))
	{
		return new ConcreteProductA();
	}
	else if(!name.compare("B") )
	{
		return new ConcreteProductB();
	}
	return  nullptr;
}
```

### 3ã€å·¥å‚æ¨¡å¼

### 4ã€æŠ½è±¡å·¥å‚æ¨¡å¼

### 5ã€å»ºé€ è€…æ¨¡å¼

### 6ã€åŸå‹æ¨¡å¼


## ğŸ“  ç»“æ„å‹è®¾è®¡æ¨¡å¼

## ğŸ“  è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼

